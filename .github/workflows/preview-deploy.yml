name: Deploy PR preview

on:
  workflow_run:
    workflows:
      - Build PR preview
    types:
      - completed

jobs:
  deploy-preview:
    runs-on: ubuntu-latest
    environment: 
      name: Staging
      url: https://portal.staging.bashaway.sliitfoss.org
    if: >
      github.event.workflow_run.event == 'pull_request' &&
      github.event.workflow_run.conclusion == 'success'
    steps:
      - name: Checkout repository ğŸ›ï¸
        uses: actions/checkout@v3

      - name: Deploy preview ğŸš€
        uses: sliit-foss/actions/preview-deployments/deploy@main
        with:
          site_domain: bashaway.sliitfoss.org
