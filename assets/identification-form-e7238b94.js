import{c as N,u as A,a as _,b as k,r as u,j as a,d as n,e as g,s as b,t as F,f as P,g as S}from"./index-ee693386.js";(function(){try{var r=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},s=new Error().stack;s&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[s]="7cfa84ab-c2fb-4a20-9607-a0f5c424f89c",r._sentryDebugIdIdentifier="sentry-dbid-7cfa84ab-c2fb-4a20-9607-a0f5c424f89c")}catch{}})();const E=N("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]),y=()=>b.dispatch(F(!1)),B=()=>{var p,h;const r=A(o=>o.ui.global.showIdentificationForm),{data:{data:s}={}}=_(),[f,{isLoading:w}]=k(),[l,m]=u.useState(s==null?void 0:s.members),[c,x]=u.useState([]);u.useEffect(()=>{s&&m(s.members)},[s]);const j=async o=>{if(o.preventDefault(),l.find(({nic:e,meal_preference:i,gender:D},C)=>!e||!c[C]||!i||!D))return n.toast({variant:"destructive",title:"Please make sure that all required fields are filled"});const t=await Promise.all(l.map(async(e,i)=>(e.student_id_url=await P(s.name,e.name,c[i]),e)));await f({id:s._id,data:{members:t}}).unwrap().then(e=>{b.dispatch(S.util.upsertQueryData("authUser",void 0,{data:e==null?void 0:e.data})),y(),n.toast({title:"Details recorded successfully"})})},v=(o,t)=>{x(e=>{const i=[...e];return i[t]=o.target.files[0],i})},d=(o,t)=>{const e=JSON.parse(JSON.stringify(l));e[t][o.target.name]=o.target.value,m(e)},I=(p=s==null?void 0:s.members)==null?void 0:p.some(o=>o.nic);return a.jsx(n.AlertDialog,{open:r,onOpenChange:o=>{o||y()},children:a.jsx(n.AlertDialogContent,{className:"max-h-[100vh] overflow-y-auto z-[200]",overlayClassName:"bg-white/80 backdrop-blur-md z-[200]",children:a.jsxs("form",{onSubmit:j,className:"flex flex-col gap-3",children:[a.jsxs(n.AlertDialogHeader,{children:[a.jsx(n.AlertDialogTitle,{children:"Hello there!"}),a.jsx(n.AlertDialogDescription,{children:I?"Looks like you've strengthened your battlion. Before we can allow your team to compete further please confirm the identity of your new members by filling what's missing below.":`Congratulations on making it to the final round of Bashaway 2023. However, before you can compete further,
              please fill in the following details.`})]}),a.jsx(n.Accordion,{type:"single",defaultValue:`member-${(h=s==null?void 0:s.members)==null?void 0:h.findIndex(o=>!o.nic)}`,collapsible:!0,children:l==null?void 0:l.map((o,t)=>a.jsxs(n.AccordionItem,{value:`member-${t}`,children:[a.jsx(n.AccordionTrigger,{children:o.name}),a.jsxs(n.AccordionContent,{containerClassName:"flex flex-col gap-3",children:[a.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[a.jsx(n.Dropdown,{filterkey:"meal_preference",label:"Meal Preference *",options:g.mealPreference.options,className:"sm:h-14",value:l[t].meal_preference,onChange:e=>d(e,t)}),a.jsx(n.Dropdown,{filterkey:"gender",label:"Gender *",options:g.gender.options,className:"sm:h-14",contentClassName:"max-h-[8.5rem] overflow-y-auto invisible-scroll",value:l[t].gender,onChange:e=>d(e,t)})]}),a.jsx(n.Input,{placeholder:"NIC *",name:"nic",value:l[t].nic,className:"sm:h-14",onChange:e=>d(e,t)}),a.jsx(n.Input,{placeholder:"University ID (both sides) *",name:"student_id_url",value:c[t]?c[t].name:l[t].student_id_url,className:"sm:h-14 cursor-pointer",onClick:()=>document.getElementById(`id-upload-${t}`).click(),suffixIcon:a.jsx(E,{className:"text-gray-400 pointer-events-none",size:21}),readOnly:!0}),a.jsx("input",{id:`id-upload-${t}`,type:"file",className:"hidden",onChange:e=>v(e,t)})]})]},t))}),a.jsx(n.AlertDialogFooter,{className:"mt-4",children:a.jsx(n.Button,{type:"submit",loading:w,children:"Submit and continue"})})]})})})};export{B as default};
//# sourceMappingURL=identification-form-e7238b94.js.map
