import{c as D,u as I,a as C,b as N,r as u,j as t,d as s,e as p,s as g,t as A,f as _,g as F}from"./index-633bb586.js";(function(){try{var r=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},l=new Error().stack;l&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[l]="aafdf70c-059f-4cb1-bf84-aa6ea8ffadf6",r._sentryDebugIdIdentifier="sentry-dbid-aafdf70c-059f-4cb1-bf84-aa6ea8ffadf6")}catch{}})();const k=D("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]),h=()=>g.dispatch(A(!1)),S=()=>{const r=I(n=>n.ui.global.showIdentificationForm),{data:{data:l}={}}=C(),[f,{isLoading:y}]=N(),[o,m]=u.useState(l==null?void 0:l.members),[c,b]=u.useState([]);u.useEffect(()=>{l&&m(l.members)},[l]);const x=async n=>{if(n.preventDefault(),o.find(({nic:e,meal_preference:i,gender:w},v)=>!e||!c[v]||!i||!w))return s.toast({variant:"destructive",title:"Please make sure that all required fields are filled"});const a=await Promise.all(o.map(async(e,i)=>(e.student_id_url=await _(l.name,e.name,c[i]),e)));await f({id:l._id,data:{members:a}}).unwrap().then(e=>{g.dispatch(F.util.upsertQueryData("authUser",void 0,{data:e==null?void 0:e.data})),h(),s.toast({title:"Details recorded successfully"})})},j=(n,a)=>{b(e=>{const i=[...e];return i[a]=n.target.files[0],i})},d=(n,a)=>{const e=JSON.parse(JSON.stringify(o));e[a][n.target.name]=n.target.value,m(e)};return t.jsx(s.AlertDialog,{open:r,onOpenChange:n=>{n||h()},children:t.jsx(s.AlertDialogContent,{className:"max-h-[100vh] overflow-y-auto z-[200]",overlayClassName:"bg-white/80 backdrop-blur-md z-[200]",children:t.jsxs("form",{onSubmit:x,className:"flex flex-col gap-3",children:[t.jsxs(s.AlertDialogHeader,{children:[t.jsx(s.AlertDialogTitle,{children:"Hello there!"}),t.jsx(s.AlertDialogDescription,{children:"Congratulations on making it to the final round of Bashaway 2023. However, before you can compete further, please fill in the following details."})]}),t.jsx(s.Accordion,{type:"single",collapsible:!0,children:o==null?void 0:o.map((n,a)=>t.jsxs(s.AccordionItem,{value:`member-${a}`,children:[t.jsx(s.AccordionTrigger,{children:n.name}),t.jsxs(s.AccordionContent,{containerClassName:"flex flex-col gap-3",children:[t.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[t.jsx(s.Dropdown,{filterkey:"meal_preference",label:"Meal Preference *",options:p.mealPreference.options,className:"sm:h-14",value:o[a].meal_preference,onChange:e=>d(e,a)}),t.jsx(s.Dropdown,{filterkey:"gender",label:"Gender *",options:p.gender.options,className:"sm:h-14",contentClassName:"max-h-[8.5rem] overflow-y-auto invisible-scroll",value:o[a].gender,onChange:e=>d(e,a)})]}),t.jsx(s.Input,{placeholder:"NIC *",name:"nic",value:o[a].nic,className:"sm:h-14",onChange:e=>d(e,a)}),t.jsx(s.Input,{placeholder:"University ID (both sides) *",name:"student_id_url",value:c[a]?c[a].name:o.student_id_url,className:"sm:h-14 cursor-pointer",onClick:()=>document.getElementById(`id-upload-${a}`).click(),suffixIcon:t.jsx(k,{className:"text-gray-400 pointer-events-none",size:21}),readOnly:!0}),t.jsx("input",{id:`id-upload-${a}`,type:"file",className:"hidden",onChange:e=>j(e,a)})]})]},a))}),t.jsx(s.AlertDialogFooter,{className:"mt-4",children:t.jsx(s.Button,{type:"submit",loading:y,children:"Submit and continue"})})]})})})};export{S as default};
//# sourceMappingURL=identification-form-36b1276a.js.map
